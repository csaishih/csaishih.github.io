<!DOCTYPE html>
<html lang="en">
	<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<link rel="stylesheet" href="../css/bootstrap.min.css">
		<link rel="stylesheet" href="../css/style.css">
	</head>
	<body>
		<div class="wrapper">
			<div class="sidebar-wrapper">
				<ul class="sidebar-nav">
					<li><a href="../index.html">Home</a></li>
					<li data-toggle="collapse" data-target="#projects"><span class="drop">Projects <span class="caret"></span></span></li>
						<ul id="projects" class="collapse in clean">
							<li><a href="./photoeditor.html">Photo Editor &#38; Enhancer</a></li>
							<li><a href="./foregroundextraction.html">Foreground Extraction</a></li>
							<li><a href="./inpaint.html" class="active">Image Inpainting</a></li>
							<li><a href="./seamcarving.html">Seam Carving</a></li>
						</ul>
					</li>
					<li><a href="../ai_shihan_resume.pdf">Resume</a></li>
					<li><a href="#">Contact</a></li>
				</ul>
			</div>
			<div class="page-content-wrapper">
				<div class="container-fluid">

					<div class="name">Exemplar-Based Image Inpainting</div>
					<hr>
					<div class="heading">What it does</div>
					<div class="block">
						<div class="text">Exemplar-Based Image Inpainting is an algorithm that removes objects from digital images and replaces the hole left behind with visually plausible textures. It allows the user to specify one or more objects in the image that they would like to remove and the algorithm will magically erase the object(s). You can read about the research <a href="http://www.irisa.fr/vista/Papers/2004_ip_criminisi.pdf">here</a>.</div>
						</br>
						<div class="text">An example of the input (left) and output (right) is shown below.</div>
						<img class="inline" src="../assets/inpaint/source.png" alt="source" />
						<img class="inline" src="../assets/inpaint/out.png" alt="out" />
						</br></br>
						<div class="text">A practical application of this algorithm is acne removal from digital photos.</div>
						<img class="inline" src="../assets/inpaint/sourceacne.png" alt="sourceacne" />
						<img class="inline" src="../assets/inpaint/outacne.png" alt="outacne" />

					</div>
					</br></br>

					<div class="heading">How it works</div>
					<div class="block">
						<div class="text">First, we provide the algorithm with a source image (left) and with a mask image (right) to indicate the region we want to remove (shown in black). We denote the region we want to remove as &Omega; (the unknown pixels) and the region we want unaltered as &Phi; (the known pixels).</div>
						<img src="../assets/inpaint/sourceworks.png" alt="sourceworks" />
						<img src="../assets/inpaint/mask.png" alt="mask" />
						</br></br>
						<div class="text">Given the region we want to remove, we find its contour with OpenCV's <a href="http://docs.opencv.org/2.4/modules/imgproc/doc/structural_analysis_and_shape_descriptors.html?highlight=findcontours#findcontours" target="_blank">findContours</a> function. For each point on the contour, we create a <a href="https://github.com/g3aishih/image-inpainting/blob/master/patch.py">Patch</a> object to represent a 9x9 patch of the image with the contour point as the center of the patch. We select one of these patches and replace it with the most similar patch from &Phi;. After we replace the patch, we update the contour and determine the patches on the contour that still need to be replaced, another patch is selected and the process repeats until all patches are replaced. The process is shown below with the patch on the contour shown in red and the most similar patch shown in green.</div>
						<img src="../assets/inpaint/algo_animation.gif" alt="animation" />
						</br></br>
						<div class="text">Each patch is assigned a priority value so that the patch to be replaced is not selected at random. The priority value is the product of two terms, the confidence term denoted C, and the data term denoted D, and they are defined as follows:</div>
						<img src="../assets/inpaint/inpaintmath.png" alt="definitions" width="330" height="60" />
						<div class="text">The confidence term is the sum of the confidence values of all known pixels in the patch divided by the area of the patch. During initialzation, all known pixels are given a confidence value of 1 and all unknown values are given a confidence value of 0. The data term is computed by normalizing the magnitude of a dot product with a normalization factor &alpha;, with &alpha; = 255. The dot product involves the vector orthogonal to the gradient of the image at the patch's center, and the unit normal of the contour at the patch's center.</div>
						</br>
						<div class="text">The priority value is critical because it allows us to fill in the removed regions in an order that correctly propagates linear structures, and is robust to changes in the shape of the region. More specifically, the confidence term reduces the sharp out-pointing appendices in the contour and the data term encourages the continuation of image structures. For more information on the confidence and data terms, please see Figure 6 in <a href="http://www.irisa.fr/vista/Papers/2004_ip_criminisi.pdf" target="_blank">Region Filling and Object Removal by Exemplar-Based Image Inpainting</a> by A. Criminisi, P. PÃ©rez, K. Toyama.
						</br></br>
						<div class="text">Without the priority value, there will be no order for selecting a patch for replacement, and the algorithm will produce results with optical artifacts as shown below.</div>
						<img src="../assets/inpaint/outbad.png" alt="bad" />
					</div>
					</br></br>

					<div class="heading">Get the code</div>
					<div class="block">
						<div class="text">The code is available on <a href="https://github.com/g3aishih/image-inpainting" target="_blank">GitHub</a></div>
					</div>

				</div>
			</div>
		</div>
    <script src="../js/jquery.min.js"></script>
		<script src="../js/bootstrap.min.js"></script>
	</body>
</html>
